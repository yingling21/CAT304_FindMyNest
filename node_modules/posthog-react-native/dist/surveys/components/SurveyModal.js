"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});exports.SurveyModal=SurveyModal;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Cancel=require("./Cancel");var _ConfirmationMessage=require("./ConfirmationMessage");var _Surveys=require("./Surveys");var _OptionalReactNativeSafeArea=require("../../optional/OptionalReactNativeSafeArea");var _jsxRuntime=require("react/jsx-runtime");var _jsxFileName="/home/runner/work/posthog-js/posthog-js/packages/react-native/dist/surveys/components/SurveyModal.js";function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap(),n=new WeakMap();return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,"default":e};if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f);}for(var _t2 in e)"default"!==_t2&&{}.hasOwnProperty.call(e,_t2)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t2))&&(i.get||i.set)?o(f,_t2,i):f[_t2]=e[_t2]);return f;})(e,t);}function SurveyModal(props){var survey=props.survey,appearance=props.appearance,onShow=props.onShow;var _useState=(0,_react.useState)(false),_useState2=(0,_slicedToArray2["default"])(_useState,2),isSurveySent=_useState2[0],setIsSurveySent=_useState2[1];var onClose=(0,_react.useCallback)(function(){return props.onClose(isSurveySent);},[isSurveySent,props]);var insets=(0,_OptionalReactNativeSafeArea.useOptionalSafeAreaInsets)();var _useState3=(0,_react.useState)(true),_useState4=(0,_slicedToArray2["default"])(_useState3,1),isVisible=_useState4[0];var shouldShowConfirmation=isSurveySent&&appearance.thankYouMessageHeader;(0,_react.useEffect)(function(){if(isVisible){onShow();}},[isVisible,onShow]);if(!isVisible){return null;}return(0,_jsxRuntime.jsx)(_reactNative.Modal,{animationType:"fade",transparent:true,onRequestClose:onClose,statusBarTranslucent:true,children:(0,_jsxRuntime.jsx)(_reactNative.KeyboardAvoidingView,{behavior:_reactNative.Platform.OS==='ios'?'padding':'height',style:{flex:1,justifyContent:'flex-end'},keyboardVerticalOffset:_reactNative.Platform.OS==='ios'?10:0,children:(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.modalBackdrop,onTouchStart:_reactNative.Keyboard.dismiss,children:(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.modalRow,children:(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.modalContent,pointerEvents:"box-none",children:(0,_jsxRuntime.jsxs)(_reactNative.View,{style:[styles.modalContentInner,{borderColor:appearance.borderColor,backgroundColor:appearance.backgroundColor,marginBottom:insets.bottom+10,marginHorizontal:10}],children:[!shouldShowConfirmation?(0,_jsxRuntime.jsx)(_Surveys.Questions,{survey:survey,appearance:appearance,onSubmit:function onSubmit(){return setIsSurveySent(true);}}):(0,_jsxRuntime.jsx)(_ConfirmationMessage.ConfirmationMessage,{appearance:appearance,header:appearance.thankYouMessageHeader,description:appearance.thankYouMessageDescription,contentType:appearance.thankYouMessageDescriptionContentType,onClose:onClose,isModal:true}),(0,_jsxRuntime.jsx)(_reactNative.View,{style:styles.topIconContainer,children:(0,_jsxRuntime.jsx)(_Cancel.Cancel,{onPress:onClose,appearance:appearance})})]})})})})})});}var styles=_reactNative.StyleSheet.create({modalBackdrop:{flex:1,justifyContent:'flex-end'},modalRow:{flexDirection:'row',justifyContent:'center'},modalContent:{width:'90%',maxWidth:400},modalContentInner:{borderRadius:10,borderWidth:1,padding:20},topIconContainer:{position:'absolute',right:-20,top:-20}});